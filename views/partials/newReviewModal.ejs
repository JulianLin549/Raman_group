<% if(currentUser){%>
<div>
    <!-- 評論modalBtn -->
    <a href="#" id="new-review-btn" class="btn btn-lg btn-primary <% if (currentUser && store.reviews.some(function (review) {return review.author.id.equals(currentUser._id)})) { %> disabled <% } %>" data-toggle="modal" data-target="#newReviewModal"> 評論或評分</a>
</div>

<!-- 評論modal -->
<div class="modal fade" id="newReviewModal" tabindex="-1" role="dialog" aria-labelledby="newReviewModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered  modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h3 class="modal-title w-100"><i class="fas fa-comment-alt-edit"></i> &nbsp 評分或評論：</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <p>店家：<%= store.name %></p>

                <%-include ("../partials/newreview") -%>

            </div>

        </div>
    </div>
</div>
<script>

    let newReviewBtn = document.getElementById('newReviewBtn');
    document.addEventListener("DOMContentLoaded", function(event) {
        if(newReviewBtn.classList.contains('disabled')){
            newReviewBtn.innerText('您已經發表評論');
        }
    });
</script>
<% }%>